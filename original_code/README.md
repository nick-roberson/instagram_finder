This is the original code that colin sent me to clean up and make easier to use.